# Prepend /opt/homebrew/bin & sbin to PATH
eval "$(/opt/homebrew/bin/brew shellenv)"


# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
# Initialization code that may require console input (password prompts, [y/n]
# confirmations, etc.) must go above this block; everything else may go below.
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

export LESS="-R --mouse"
export GPG_TTY="${TTY:-$(tty)}"

# If you come from bash you might have to change your $PATH.
# export PATH=$HOME/bin:/usr/local/bin:$PATH
export PATH="$PATH:/Users/arnau/Library/Flutter/flutter/bin"

# Path to Flutter thins
export PATH="$PATH":"$HOME/.pub-cache/bin"

# Path to Doxygen exec
export PATH=$PATH:/Applications/Doxygen.app/Contents/Resources

# Powerlevel10k (no Oh My Zsh) 
# To customize prompt, run `p10k configure` or edit ~/.p10k.zsh.
source "$(brew --prefix)/share/powerlevel10k/powerlevel10k.zsh-theme"
[[ -f ~/.p10k.zsh ]] && source ~/.p10k.zsh

# fzf key bindings (Ctrl-R fuzzy history) + completion
source "$(brew --prefix)/opt/fzf/shell/key-bindings.zsh"
source "$(brew --prefix)/opt/fzf/shell/completion.zsh"

# Zsh plugins (load highlighting last)
source "$(brew --prefix)/share/zsh-autosuggestions/zsh-autosuggestions.zsh"


# User configuration

# export MANPATH="/usr/local/man:$MANPATH"

# You may need to manually set your language environment
# export LANG=en_US.UTF-8

# Preferred editor for local and remote sessions
# if [[ -n $SSH_CONNECTION ]]; then
#   export EDITOR='vim'
# else
#   export EDITOR='mvim'
# fi
# Compilation flags
# export ARCHFLAGS="-arch x86_64"

# Set personal aliases, overriding those provided by oh-my-zsh libs,
# plugins, and themes. Aliases can be placed here, though oh-my-zsh
# users are encouraged to define aliases within the ZSH_CUSTOM folder.
# For a full list of active aliases, run `alias`.
#
# Example aliases
# alias zshconfig="mate ~/.zshrc"
# alias ohmyzsh="mate ~/.oh-my-zsh"
alias gs="git status"
alias gl="git log --graph --decorate --all"


# Herd injected PHP 8.3 configuration.
export HERD_PHP_83_INI_SCAN_DIR="/Users/arnau/Library/Application Support/Herd/config/php/83/"

# Herd injected NVM configuration
export NVM_DIR="/Users/arnau/Library/Application Support/Herd/config/nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm

[[ -f "/Applications/Herd.app/Contents/Resources/config/shell/zshrc.zsh" ]] && builtin source "/Applications/Herd.app/Contents/Resources/config/shell/zshrc.zsh"

# Herd injected PHP binary.
export PATH="/Users/arnau/Library/Application Support/Herd/bin/":$PATH

# Herd injected PHP 8.4 configuration.
export HERD_PHP_84_INI_SCAN_DIR="/Users/arnau/Library/Application Support/Herd/config/php/84/"


# bun completions
[ -s "/Users/arnau/.bun/_bun" ] && source "/Users/arnau/.bun/_bun"

# bun
export BUN_INSTALL="$HOME/.bun"
export PATH="$BUN_INSTALL/bin:$PATH"

# STM32CubeMX
export STM32CubeMX_PATH=/Applications/STMicroelectronics/STM32CubeMX.app/Contents/Resources
# Added by Antigravity
export PATH="/Users/arnau/.antigravity/antigravity/bin:$PATH"


# Needs to be LAST source!!
source "$(brew --prefix)/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh"


# Zsh completion system
autoload -Uz compinit
compinit

# Enable menu selection with visual highlight
zstyle ':completion:*' menu select
# Use LS_COLORS for completion list coloring (dirs, symlinks, executables)
zstyle ':completion:*' list-colors ${(s.:.)LS_COLORS}
# Allow arrow keys to move through menu selection
zstyle ':completion:*' menu select=long
# Sort git branches by recent use
zstyle ':completion:*:git-checkout:*' sort false
# Avoid expensive completion for very large directories
zstyle ':completion:*' max-errors 2

# Automatically rehash commands when new ones appear in PATH
zstyle ':completion:*' rehash true

# Case-insensitive completion (foo matches Foo, FOO, etc.)
zstyle ':completion:*' matcher-list 'm:{a-z}={A-Za-z}'

# Partial / substring matching (cd dow â†’ Downloads)
zstyle ':completion:*' matcher-list \
  'm:{a-z}={A-Za-z}' \
  'r:|[._-]=* r:|=*'

# Group completion results (e.g. files, dirs, commands)
zstyle ':completion:*' group-name ''

# Add descriptive text to completion entries
zstyle ':completion:*:descriptions' format '%F{yellow}%d%f'

# Show warnings when no matches are found
zstyle ':completion:*:warnings' format '%F{red}No matches found%f'
